name: Deployment
on: deployment
jobs:
  deployment:
    runs-on: ubuntu-latest
    steps:
      - name: Deployment pending
        uses: deliverybot/deployment-status@master
        with:
          environment-url: ${{ github.event.deployment.payload.url }}
          state: pending
          token: ${{ secrets.GITHUB_TOKEN }}
      - name: Deployment info
        run: |
          echo environment - ${{ github.event.deployment.task }}
          echo payload - ${{ github.event.deployment.payload }}
      - name: Deployment success
        if: success()
        uses: deliverybot/deployment-status@master
        with:
          environment-url: ${{ github.event.deployment.payload.url }}
          state: success
          token: ${{ secrets.GITHUB_TOKEN }}
      - name: Deployment failure
        if: failure()
        uses: deliverybot/deployment-status@master
        with:
          environment-url: ${{ github.event.deployment.payload.url }}
          state: failure
          token: ${{ secrets.GITHUB_TOKEN }}
  context:
    runs-on: ubuntu-latest
    steps:
      - name: Dump GitHub context
        env:
          GITHUB_CONTEXT: ${{ toJson(github) }}
        run: echo "$GITHUB_CONTEXT"
